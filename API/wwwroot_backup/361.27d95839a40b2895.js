"use strict";(self.webpackChunkvex=self.webpackChunkvex||[]).push([[361],{3361:(R,b,n)=>{n.r(b),n.d(b,{LoginComponent:()=>S});var s=n(6223),d=n(8109),C=n(2939),P=n(3951),L=n(5986),Z=n(617),y=n(2596),f=n(2296),T=n(6814),A=n(2032),g=n(4170),m=n(1365),O=n(4104),U=n(8525),t=n(9212),l=n(6306),v=n(8504),x=n(7398),h=n(4697),M=n(9862);let I=(()=>{class i{constructor(e){this.http=e,this.baseUrl=h.N.apiUrl+"/account",this.isOpt=!1}uploadPatientPhoto(e){return this.http.post(`${h.N.apiUrl}/Patients/upload-photo`,e).pipe((0,l.K)(this.handleError))}sendPusher(e){return this.http.post(`${this.baseUrl}/challange`,e).pipe((0,l.K)(this.handleError))}getProfile(e){return this.http.post(`${this.baseUrl}/getProfile`,e).pipe((0,l.K)(this.handleError))}getCourse(e){return this.http.post(`${this.baseUrl}/getCourse`,e).pipe((0,l.K)(this.handleError))}getCourseItems(e){return this.http.post(`${this.baseUrl}/getCourseItems`,e).pipe((0,l.K)(this.handleError))}getCourseItemView(e){return this.http.post(`${this.baseUrl}/getCourseItemView`,e).pipe((0,l.K)(this.handleError))}getCourseItemInfo(e){return this.http.post(`${this.baseUrl}/getCourseItemInfo`,e).pipe((0,l.K)(this.handleError))}handleError(e){return e.error instanceof ErrorEvent?console.error("An error occurred:",e.error.message):console.error(`Backend returned code ${e.status}, body was: ${e.error}`),(0,v._)("Something bad happened; please try again later.")}getProfile2(e){return this.http.post(`${this.baseUrl}/getProfile`,e)}testApi(e){return this.http.post(`${this.baseUrl}/testapi`,e)}register(e){return this.http.post(`${this.baseUrl}/register`,e)}loginPlatform(e){return console.log("Login data:",e),this.http.post(`${this.baseUrl}/login`,{email:e.email,password:e.password}).pipe((0,x.U)(o=>(console.log("Login response:",o),o)),(0,l.K)(o=>(console.error("Login error:",o),(0,v._)(o.error?()=>o.error:()=>o))))}sendOtp(e){const r=h.N.apiUrl+"/otp/";return console.log(r),this.http.get(r+e).pipe((0,x.U)(o=>(console.log(o),o)))}verifyOtp(e){return this.http.post(h.N.apiUrl+"/otp",{identifier:e.email,otp:e.otp}).pipe((0,x.U)(a=>(console.log(a),a)))}static#t=this.\u0275fac=function(r){return new(r||i)(t.LFG(M.eN))};static#e=this.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var w=n(3211),F=n(2425),N=n(376),E=n(9388),J=n(3680);function j(i,p){1&i&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(),t.hij(" ",t.lcZ(2,1,"Email is required")," "))}function Y(i,p){1&i&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(),t.hij(" ",t.lcZ(2,1,"Please enter a valid email address")," "))}function $(i,p){1&i&&(t.TgZ(0,"mat-icon"),t._uU(1,"visibility"),t.qZA())}function k(i,p){1&i&&(t.TgZ(0,"mat-icon"),t._uU(1,"visibility_off"),t.qZA())}function K(i,p){1&i&&(t.TgZ(0,"mat-error"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&i&&(t.xp6(),t.hij(" ",t.lcZ(2,1,"Password is required")," "))}const Q=()=>["/forgot-password"];let S=(()=>{class i{constructor(e,r,o,a,c,u,D,G,V,z){this.router=e,this.fb=r,this.cd=o,this.snackbar=a,this.route=c,this.API=u,this.user=D,this.toastr=G,this.configService=V,this.translate=z,this.model={},this.errors="",this.inputType="password",this.visible=!1,this.loginForm=this.fb.group({email:["",[s.kI.required,s.kI.email]],password:["",s.kI.required]}),this.selectedLang="en",this.selectedLang=localStorage.getItem("userLang")||"en",this.translate.setDefaultLang(this.selectedLang),this.translate.use(this.selectedLang),this.configService.updateConfig("ar"===this.selectedLang?{direction:"rtl"}:{direction:"ltr"}),this.translate.setDefaultLang(this.selectedLang),this.translate.use(this.selectedLang)}changeLanguage(e){this.translate.use(e),localStorage.setItem("userLang",e),this.selectedLang=e}ngOnInit(){}login(){this.loginForm.invalid||this.API.loginPlatform(this.loginForm.value).subscribe({next:e=>{console.log("Login response:",e),localStorage.setItem("token",e.token),this.user.setUpdateCurrentUser(e);const r=Array.isArray(e.roles)?e.roles:[e.role||e.roles];console.log("User roles:",r),r.some(o=>"Admin"===o)?this.router.navigate(["/admin"]):r.some(o=>"TaxManager"===o)?this.router.navigate(["/dashboard"]):r.some(o=>"Accountant"===o)?this.router.navigate(["/tax-filings"]):r.some(o=>"Clerk"===o)?this.router.navigate(["/clients"]):r.some(o=>"Validator"===o)?this.router.navigate(["/validation/dashboard"]):r.some(o=>"Client"===o)?this.router.navigate(["/documents"]):this.router.navigate(["/dashboard"]),this.toastr.success("Login successful!","Welcome")},error:e=>{console.error("Login error:",e),e.error&&e.error.errors&&Array.isArray(e.error.errors)?e.error.errors.forEach(r=>{this.toastr.error(r,"Login Failed")}):this.toastr.error(e.error&&e.error.message?e.error.message:e.message?e.message:"Invalid login credentials","Login Failed")}})}handleResponse(e){this.errors="",console.log(e)}handleErro(e){this.extract_error(e)}extract_error(e){this.errors="",e.error.userLogin&&(this.errors=e.error.userLogin),e.error.password&&(this.errors=e.error.password),e.error.password_confirm&&(this.errors=e.error.password_confirm),console.log(e.error),console.log(this.errors)}toggleVisibility(){this.visible?(this.inputType="password",this.visible=!1,this.cd.markForCheck()):(this.inputType="text",this.visible=!0,this.cd.markForCheck())}static#t=this.\u0275fac=function(r){return new(r||i)(t.Y36(d.F0),t.Y36(s.qu),t.Y36(t.sBO),t.Y36(C.ux),t.Y36(d.gz),t.Y36(I),t.Y36(w.K),t.Y36(F._W),t.Y36(N.Y),t.Y36(m.sK))};static#e=this.\u0275cmp=t.Xpm({type:i,selectors:[["vex-login"]],standalone:!0,features:[t.jDz],decls:50,vars:33,consts:[["dir","rtl",1,"card","shadow-xl","text-center","w-full","max-w-sm","overflow-hidden"],[1,"w-full","h-full","bg-pattern","flex","flex-col","items-center","justify-center",2,"opacity","1"],[1,"language-selector-container"],[3,"ngModel","ngModelChange","selectionChange"],["value","en"],["value","ar"],[1,"w-full","h-full","bg-pattern","flex","flex-col","items-center","justify-center"],[1,"card","overflow-hidden","w-full"],[1,"p-3","pb-0","flex","flex-col","items-center","justify-center"],[1,"fill-current","text-center"],["src","assets/img/Medical/logo.png",1,"w-17",2,"width","auto","height","auto"],[1,"text-center","mt-4"],[1,"title","m-0",2,"font-weight","bold","color","#00a2e9"],[1,"body-2","text-secondary","m-0",2,"color","#00a2e9","font-weight","bold"],[1,"p-6","flex","flex-col","gap-4",3,"formGroup"],[1,"flex","flex-col"],[1,"w-full"],["formControlName","email","matInput","","required","","type","email"],[4,"ngIf"],["formControlName","password","matInput","","required","",3,"type"],["mat-icon-button","","matSuffix","","matTooltip","Toggle Visibility","type","button",3,"click"],[1,"flex","items-center","justify-between"],["color","primary",1,"caption"],[1,"caption",3,"routerLink"],["color","primary","mat-raised-button","","type","button",3,"click"]],template:function(r,o){if(1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"mat-form-field")(4,"mat-label"),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"mat-select",3),t.NdJ("ngModelChange",function(c){return o.selectedLang=c})("selectionChange",function(c){return o.changeLanguage(c.value)}),t.TgZ(8,"mat-option",4),t._uU(9,"EN"),t.qZA(),t.TgZ(10,"mat-option",5),t._uU(11,"AR"),t.qZA()()()(),t.TgZ(12,"div",6)(13,"div",7)(14,"div",8)(15,"div",9),t._UZ(16,"img",10),t.qZA()(),t.TgZ(17,"div",11)(18,"h2",12),t._uU(19),t.ALo(20,"translate"),t.qZA(),t._UZ(21,"h4",13),t.qZA(),t.TgZ(22,"div",14)(23,"div",15)(24,"mat-form-field",16)(25,"mat-label"),t._uU(26),t.ALo(27,"translate"),t.qZA(),t._UZ(28,"input",17),t.YNc(29,j,3,3,"mat-error",18)(30,Y,3,3,"mat-error",18),t.qZA(),t.TgZ(31,"mat-form-field",16)(32,"mat-label"),t._uU(33),t.ALo(34,"translate"),t.qZA(),t._UZ(35,"input",19),t.TgZ(36,"button",20),t.NdJ("click",function(){return o.toggleVisibility()}),t.YNc(37,$,2,0,"mat-icon",18)(38,k,2,0,"mat-icon",18),t.qZA(),t.YNc(39,K,3,3,"mat-error",18),t.qZA()(),t.TgZ(40,"div",21)(41,"mat-checkbox",22),t._uU(42),t.ALo(43,"translate"),t.qZA(),t.TgZ(44,"a",23),t._uU(45),t.ALo(46,"translate"),t.qZA()(),t.TgZ(47,"button",24),t.NdJ("click",function(){return o.login()}),t._uU(48),t.ALo(49,"translate"),t.qZA()()()()()()),2&r){let a,c,u;t.Q6J("@fadeInUp",void 0),t.xp6(5),t.Oqu(t.lcZ(6,18,"SELECT_LANGUAGE")),t.xp6(2),t.Q6J("ngModel",o.selectedLang),t.xp6(6),t.Q6J("@fadeInUp",void 0),t.xp6(6),t.hij(" ",t.lcZ(20,20,"LOGIN_FORM"),""),t.xp6(3),t.Q6J("formGroup",o.loginForm),t.xp6(4),t.Oqu(t.lcZ(27,22,"Email")),t.xp6(3),t.Q6J("ngIf",null==(a=o.loginForm.get("email"))?null:a.hasError("required")),t.xp6(),t.Q6J("ngIf",null==(c=o.loginForm.get("email"))?null:c.hasError("email")),t.xp6(3),t.Oqu(t.lcZ(34,24,"Password")),t.xp6(2),t.Q6J("type",o.inputType),t.xp6(2),t.Q6J("ngIf",o.visible),t.xp6(),t.Q6J("ngIf",!o.visible),t.xp6(),t.Q6J("ngIf",null==(u=o.loginForm.get("password"))?null:u.hasError("required")),t.xp6(3),t.hij(" ",t.lcZ(43,26,"Remember_Me"),""),t.xp6(2),t.Q6J("routerLink",t.DdM(32,Q)),t.xp6(),t.hij(" ",t.lcZ(46,28,"Forgot_Password"),"?"),t.xp6(3),t.hij(" ",t.lcZ(49,30,"SIGN_IN")," ")}},dependencies:[s.UX,s.Fj,s.JJ,s.JL,s.Q7,s.sg,s.u,g.lN,g.KE,g.hX,g.TO,g.R9,E.Lv,A.c,A.Nt,T.O5,f.ot,f.lW,f.RK,y.AV,y.gM,Z.Ps,Z.Hw,L.p9,L.oG,d.rH,C.ZX,U.LD,U.gD,J.ey,m.aw,m.X$,d.Bz,O.Nh,s.u5,s.On],styles:['@charset "UTF-8";form[_ngcontent-%COMP%]{border:3px solid #f1f1f1}input[type=text][_ngcontent-%COMP%], input[type=password][_ngcontent-%COMP%]{width:100%;padding:12px 20px;margin:8px 0;display:inline-block;border:1px solid #ccc;box-sizing:border-box}button[_ngcontent-%COMP%]{background-color:#00bbd3;color:#fff;padding:14px 20px;margin:8px 0;border:none;cursor:pointer;width:100%}button[_ngcontent-%COMP%]:hover{opacity:.8}.cancelbtn[_ngcontent-%COMP%]{width:auto;padding:10px 18px;background-color:#f44336}.imgcontainer[_ngcontent-%COMP%]{text-align:center;margin:24px 0 12px}img.avatar[_ngcontent-%COMP%]{width:40%;border-radius:50%}.container[_ngcontent-%COMP%]{padding:5px}span.psw[_ngcontent-%COMP%]{float:right;padding-top:8px}@media screen and (max-width: 300px){span.psw[_ngcontent-%COMP%]{display:block;float:none}.cancelbtn[_ngcontent-%COMP%]{width:100%}}.toast[_ngcontent-%COMP%]{font-family:Arial,sans-serif}.toast-success[_ngcontent-%COMP%]{background-color:#b60cd8;color:#fff}.toast-error[_ngcontent-%COMP%]{background-color:#d9534f;color:#fff}.toast-info[_ngcontent-%COMP%]{background-color:#5bc0de;color:#fff}.toast-warning[_ngcontent-%COMP%]{background-color:#f0ad4e;color:#fff}.mat-select-value[_ngcontent-%COMP%]{color:#f0f0f0}.language-selector-container[_ngcontent-%COMP%]{display:flex;align-items:center;position:absolute;top:0;left:0;padding:10px;color:#ececec}.custom-mat-select[_ngcontent-%COMP%]{margin-left:10px;width:auto;min-width:20px}  .mat-select-value{color:#e6e6e6}  .option-en{color:#fafafa}  .option-ar{color:#fff}.mat-select-value-text[_ngcontent-%COMP%]{color:#f0ad4e}[_nghost-%COMP%]{align-content:center;align-items:center;background:#fff url(background1.5ad2c03de06207a5.png);background-size:cover;display:flex;flex-direction:column;height:100%;justify-content:center;justify-items:center;width:100%}'],data:{animation:[P.$]},changeDetection:0})}return i})()}}]);