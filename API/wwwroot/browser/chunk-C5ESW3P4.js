import{B as F,E as z,F as j,G as B,H as N,b as T,c as $,ca as V,d as H,da as R,va as q,wa as J,x as G}from"./chunk-I6ZOHNIY.js";import{a as K,b as E}from"./chunk-EWVCNHQE.js";import{k,r as D,w as y,x as I}from"./chunk-I6OR3I6N.js";import{Ab as b,C as p,Ec as m,Fc as h,Ib as x,Kb as _,Sb as a,Tb as o,X as f,Yb as P,ba as U,cc as M,ga as S,hb as l,m as i,nb as C,oc as O,pc as c,qa as v,qc as g,r as u,ra as w,ub as A}from"./chunk-LPVC7MPI.js";var Q=(()=>{class s{constructor(e,t){this.http=e,this.authService=t,this.apiUrl=K.apiUrl+"admin"}getHeaders(){let e=this.authService.getAuthToken();return new y({"Content-Type":"application/json",Authorization:`Bearer ${e}`})}getAllUsers(){return this.http.get(`${this.apiUrl}/users-with-roles`,{headers:this.getHeaders()}).pipe(u(e=>e.map(t=>({id:t.id,code:t.code,description:t.description,country:t.country,role:t.role,isActive:t.isActive,preferredLanguage:t.preferredLanguage||"ar",token:t.token}))),p(e=>(console.error("Error fetching users:",e),i([]))))}getActiveUsers(){return this.getAllUsers().pipe(u(e=>e.filter(t=>t.isActive)))}addUser(e){let t={code:e.code,password:e.password||"defaultPassword123",description:e.description,role:e.role,isActive:e.isActive,country:e.country,preferredLanguage:e.preferredLanguage||"ar"};return this.http.post(`${this.apiUrl}/create`,t,{headers:this.getHeaders()}).pipe(u(()=>!0),p(r=>(console.error("Error adding user:",r),i(!1))))}updateUser(e){let t={code:e.code,description:e.description,country:e.country,role:e.role,isActive:e.isActive};return this.http.put(`${this.apiUrl}/update-user/${e.id}`,t,{headers:this.getHeaders()}).pipe(u(()=>!0),p(r=>(console.error("Error updating user:",r),i(!1))))}deleteUser(e){return this.getAllUsers().pipe(f(t=>{let r=t.find(n=>n.code===e);return r&&r.id?this.http.delete(`${this.apiUrl}/delete-user/${r.id}`,{headers:this.getHeaders()}).pipe(u(()=>!0),p(n=>(console.error("Error deleting user:",n),i(!1)))):i(!1)}),p(()=>i(!1)))}activateUser(e){return this.getAllUsers().pipe(f(t=>{let r=t.find(n=>n.code===e);return r&&r.id?this.http.post(`${this.apiUrl}/activate-user/${r.id}`,{},{headers:this.getHeaders()}).pipe(u(()=>!0),p(n=>(console.error("Error activating user:",n),i(!1)))):i(!1)}),p(()=>i(!1)))}deactivateUser(e){return this.getAllUsers().pipe(f(t=>{let r=t.find(n=>n.code===e);return r&&r.id?this.http.post(`${this.apiUrl}/deactivate-user/${r.id}`,{},{headers:this.getHeaders()}).pipe(u(()=>!0),p(n=>(console.error("Error deactivating user:",n),i(!1)))):i(!1)}),p(()=>i(!1)))}resetUserPassword(e,t){return this.getAllUsers().pipe(f(r=>{let n=r.find(d=>d.code===e);return n&&n.id?this.http.post(`${this.apiUrl}/reset-password`,{userId:n.id.toString(),newPassword:t},{headers:this.getHeaders()}).pipe(u(()=>!0),p(d=>(console.error("Error resetting password:",d),i(!1)))):i(!1)}),p(()=>i(!1)))}isUserCodeUnique(e){return this.http.get(`${this.apiUrl}/check-code/${e}`,{headers:this.getHeaders()}).pipe(u(t=>!t),p(t=>(console.error("Error checking user code:",t),i(!0))))}generateUserCode(){return"USER"+Math.random().toString(36).substr(2,6).toUpperCase()}ensureRolesExist(){return this.http.post(`${this.apiUrl}/ensure-roles`,{},{headers:this.getHeaders()}).pipe(p(e=>(console.error("Error ensuring roles exist:",e),i(null))))}toggleUploaderRole(e){return this.http.post(`${this.apiUrl}/toggle-uploader-role/${e}`,{},{headers:this.getHeaders()}).pipe(p(t=>(console.error("Error toggling uploader role:",t),i(null))))}updateUserLanguage(e,t){return this.http.post(`${this.apiUrl}/update-user-language/${e}`,t,{headers:this.getHeaders()}).pipe(u(()=>!0),p(r=>(console.error("Error updating user language:",r),i(!1))))}static{this.\u0275fac=function(t){return new(t||s)(S(I),S(E))}}static{this.\u0275prov=U({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})();function Z(s,L){s&1&&(a(0,"mat-icon",14),c(1,"check"),o())}function ee(s,L){s&1&&(a(0,"mat-icon",14),c(1,"check"),o())}function te(s,L){s&1&&(a(0,"mat-icon",14),c(1,"check"),o())}var we=(()=>{class s{constructor(e,t,r){this.translate=e,this.authService=t,this.userService=r,this.currentLang="ar"}ngOnInit(){this.translate.setDefaultLang("ar");let e=this.authService.getCurrentUser();e&&e.preferredLanguage?(this.currentLang=e.preferredLanguage,this.translate.use(e.preferredLanguage)):this.currentLang=this.translate.currentLang||"ar",this.updateDocumentDirection(this.currentLang)}switchLanguage(e){this.currentLang=e,this.translate.use(e),this.updateDocumentDirection(e),localStorage.setItem("preferredLanguage",e);let t=this.authService.getCurrentUser();t&&(t.preferredLanguage=e,this.authService.updateCurrentUserFromStorage(),this.userService.updateUserLanguage(t.code,e).subscribe(r=>{r?console.log("User language preference updated successfully"):console.error("Failed to update user language preference")},r=>{console.error("Error updating user language preference:",r)}))}getCurrentFlag(){switch(this.currentLang){case"ar":return"\u{1F1F8}\u{1F1E6}";case"en":return"\u{1F1FA}\u{1F1F8}";case"fr":return"\u{1F1EB}\u{1F1F7}";default:return"\u{1F1F8}\u{1F1E6}"}}updateDocumentDirection(e){let t=document.documentElement,r=document.body;e==="ar"?(t.setAttribute("dir","rtl"),t.setAttribute("lang","ar"),r.classList.add("rtl"),r.classList.remove("ltr")):(t.setAttribute("dir","ltr"),t.setAttribute("lang",e),r.classList.add("ltr"),r.classList.remove("rtl"))}static{this.\u0275fac=function(t){return new(t||s)(C(T),C(E),C(Q))}}static{this.\u0275cmp=A({type:s,selectors:[["app-language-switcher"]],decls:43,vars:26,consts:[["languageMenu","matMenu"],["mat-icon-button","",1,"language-switcher-btn",3,"matMenuTriggerFor","matTooltip"],[1,"language-btn-content"],[1,"current-flag"],[1,"dropdown-icon"],[1,"language-menu"],[1,"menu-header"],[1,"menu-title"],["mat-menu-item","",1,"lang-option",3,"click"],[1,"lang-content"],[1,"flag-icon"],[1,"lang-name"],[1,"lang-native"],["class","check-icon",4,"ngIf"],[1,"check-icon"]],template:function(t,r){if(t&1){let n=P();a(0,"button",1),m(1,"translate"),a(2,"div",2)(3,"span",3),c(4),o(),a(5,"mat-icon",4),c(6,"expand_more"),o()()(),a(7,"mat-menu",5,0)(9,"div",6)(10,"span",7),c(11),m(12,"translate"),o()(),a(13,"button",8),M("click",function(){return v(n),w(r.switchLanguage("ar"))}),a(14,"div",9)(15,"span",10),c(16,"\u{1F1F8}\u{1F1E6}"),o(),a(17,"span",11),c(18),m(19,"translate"),o(),a(20,"span",12),c(21,"\u0627\u0644\u0639\u0631\u0628\u064A\u0629"),o()(),b(22,Z,2,0,"mat-icon",13),o(),a(23,"button",8),M("click",function(){return v(n),w(r.switchLanguage("en"))}),a(24,"div",9)(25,"span",10),c(26,"\u{1F1FA}\u{1F1F8}"),o(),a(27,"span",11),c(28),m(29,"translate"),o(),a(30,"span",12),c(31,"English"),o()(),b(32,ee,2,0,"mat-icon",13),o(),a(33,"button",8),M("click",function(){return v(n),w(r.switchLanguage("fr"))}),a(34,"div",9)(35,"span",10),c(36,"\u{1F1EB}\u{1F1F7}"),o(),a(37,"span",11),c(38),m(39,"translate"),o(),a(40,"span",12),c(41,"Fran\xE7ais"),o()(),b(42,te,2,0,"mat-icon",13),o()()}if(t&2){let n=O(8);x("matMenuTriggerFor",n)("matTooltip",h(1,16,"LANGUAGES.SELECT_LANGUAGE")),l(4),g(r.getCurrentFlag()),l(7),g(h(12,18,"LANGUAGES.SELECT_LANGUAGE")),l(2),_("active",r.currentLang==="ar"),l(5),g(h(19,20,"LANGUAGES.ARABIC")),l(4),x("ngIf",r.currentLang==="ar"),l(),_("active",r.currentLang==="en"),l(5),g(h(29,22,"LANGUAGES.ENGLISH")),l(4),x("ngIf",r.currentLang==="en"),l(),_("active",r.currentLang==="fr"),l(5),g(h(39,24,"LANGUAGES.FRENCH")),l(4),x("ngIf",r.currentLang==="fr")}},dependencies:[D,k,F,G,R,V,N,j,z,B,J,q,H,$],styles:[".language-switcher-btn[_ngcontent-%COMP%]{margin-left:8px;color:#fff;width:48px!important;height:48px!important;background:#ffffff26!important;border:1px solid rgba(255,255,255,.25)!important;border-radius:50%!important;transition:all .3s ease!important;box-shadow:0 2px 8px #0000001a!important}.language-switcher-btn[_ngcontent-%COMP%]:hover{background:#ffffff40!important;transform:scale(1.1)!important;box-shadow:0 6px 16px #0003!important;border-color:#ffffff59!important}.language-switcher-btn[_ngcontent-%COMP%]:active{transform:scale(.95)!important}.language-btn-content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%;gap:4px}.current-flag[_ngcontent-%COMP%]{font-size:20px;filter:drop-shadow(0 1px 2px rgba(0,0,0,.2))}.dropdown-icon[_ngcontent-%COMP%]{font-size:18px!important;width:18px!important;height:18px!important;color:#ffffffe6!important;transition:transform .3s ease!important}.language-switcher-btn[_ngcontent-%COMP%]:hover   .dropdown-icon[_ngcontent-%COMP%]{transform:rotate(180deg)!important}.language-menu[_ngcontent-%COMP%]{margin-top:8px;border-radius:12px!important;overflow:hidden!important;box-shadow:0 8px 32px #00000026!important;border:1px solid rgba(255,255,255,.1)!important;-webkit-backdrop-filter:blur(20px)!important;backdrop-filter:blur(20px)!important}.menu-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);padding:12px 16px;border-bottom:1px solid rgba(255,255,255,.1)}.menu-title[_ngcontent-%COMP%]{color:#fff;font-size:14px;font-weight:600;text-align:center;display:block}.lang-option[_ngcontent-%COMP%]{display:flex!important;align-items:center!important;justify-content:space-between!important;padding:12px 16px!important;transition:all .2s ease!important;border:none!important;background:transparent!important}.lang-option[_ngcontent-%COMP%]:hover{background:#667eea1a!important;transform:translate(4px)!important}.lang-option.active[_ngcontent-%COMP%]{background:#667eea26!important;border-left:3px solid #667eea!important}.lang-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;flex:1}.flag-icon[_ngcontent-%COMP%]{font-size:20px;filter:drop-shadow(0 1px 2px rgba(0,0,0,.2))}.lang-name[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#333}.lang-native[_ngcontent-%COMP%]{font-size:12px;color:#666;font-style:italic}.check-icon[_ngcontent-%COMP%]{color:#667eea!important;font-size:18px!important;width:18px!important;height:18px!important}[dir=rtl][_ngcontent-%COMP%]   .language-switcher-btn[_ngcontent-%COMP%]{margin-left:0;margin-right:8px}[dir=rtl][_ngcontent-%COMP%]   .lang-option[_ngcontent-%COMP%]:hover{transform:translate(-4px)!important}[dir=rtl][_ngcontent-%COMP%]   .lang-option.active[_ngcontent-%COMP%]{border-left:none!important;border-right:3px solid #667eea!important}@media (max-width: 768px){.language-switcher-btn[_ngcontent-%COMP%]{width:44px!important;height:44px!important}.current-flag[_ngcontent-%COMP%]{font-size:18px}.dropdown-icon[_ngcontent-%COMP%]{font-size:16px!important;width:16px!important;height:16px!important}}@media (max-width: 480px){.language-switcher-btn[_ngcontent-%COMP%]{width:40px!important;height:40px!important}.current-flag[_ngcontent-%COMP%]{font-size:16px}.dropdown-icon[_ngcontent-%COMP%]{font-size:14px!important;width:14px!important;height:14px!important}}"]})}}return s})();export{Q as a,we as b};
