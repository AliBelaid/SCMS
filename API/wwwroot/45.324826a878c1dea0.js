"use strict";(self.webpackChunkvex=self.webpackChunkvex||[]).push([[45],{5924:(x,l,o)=>{o.r(l),o.d(l,{UsersListComponent:()=>nt});var m=o(177),d=o(9192),p=o(9417),P=o(1413),g=o(6977),c=o(5596),E=o(8834),F=o(9213),u=o(9159),C=o(6695),h=o(2042),_=o(2102),M=o(9631),D=o(6471),b=o(4823),f=o(9115),O=o(9183),U=o(4006),t=o(4438),A=o(18),L=o(5048);const R=()=>[10,25,50,100];function T(n,s){if(1&n){const e=t.RV6();t.j41(0,"button",20),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.navigateToCreate())}),t.j41(1,"mat-icon"),t.EFF(2,"add"),t.k0s(),t.EFF(3," \u0625\u0636\u0627\u0641\u0629 \u0645\u0633\u062a\u062e\u062f\u0645 \u062c\u062f\u064a\u062f "),t.k0s()}}function j(n,s){if(1&n){const e=t.RV6();t.j41(0,"button",21),t.bIt("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.clearFilter())}),t.j41(1,"mat-icon"),t.EFF(2,"clear"),t.k0s()()}}function k(n,s){1&n&&(t.j41(0,"div",22),t.nrm(1,"mat-spinner",23),t.j41(2,"p"),t.EFF(3,"\u062c\u0627\u0631\u064a \u062a\u062d\u0645\u064a\u0644 \u0627\u0644\u0628\u064a\u0627\u0646\u0627\u062a..."),t.k0s()())}function I(n,s){1&n&&(t.j41(0,"th",40),t.EFF(1,"\u0627\u0644\u0631\u0645\u0632"),t.k0s())}function y(n,s){if(1&n&&(t.j41(0,"td",41),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.R7$(),t.JRh(e.code)}}function $(n,s){1&n&&(t.j41(0,"th",40),t.EFF(1,"\u0627\u0644\u0627\u0633\u0645"),t.k0s())}function B(n,s){if(1&n&&(t.j41(0,"td",41),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.R7$(),t.JRh(e.description||e.code)}}function G(n,s){1&n&&(t.j41(0,"th",42),t.EFF(1,"\u0627\u0644\u0628\u0631\u064a\u062f \u0627\u0644\u0625\u0644\u0643\u062a\u0631\u0648\u0646\u064a"),t.k0s())}function S(n,s){if(1&n&&(t.j41(0,"td",41),t.EFF(1),t.k0s()),2&n){const e=s.$implicit;t.R7$(),t.JRh(e.email||"\u063a\u064a\u0631 \u0645\u062a\u0648\u0641\u0631")}}function N(n,s){1&n&&(t.j41(0,"th",40),t.EFF(1,"\u0627\u0644\u062f\u0648\u0631"),t.k0s())}function K(n,s){if(1&n&&(t.j41(0,"td",41)(1,"mat-chip",43),t.EFF(2),t.k0s()()),2&n){const e=s.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("color",i.getRoleColor(e.role)),t.R7$(),t.SpI(" ",i.getRoleLabel(e.role)," ")}}function W(n,s){1&n&&(t.j41(0,"th",42),t.EFF(1,"\u0627\u0644\u062d\u0627\u0644\u0629"),t.k0s())}function V(n,s){if(1&n&&(t.j41(0,"td",41)(1,"mat-chip",43),t.EFF(2),t.k0s()()),2&n){const e=s.$implicit;t.R7$(),t.Y8G("color",e.isActive?"primary":"warn"),t.R7$(),t.SpI(" ",e.isActive?"\u0646\u0634\u0637":"\u063a\u064a\u0631 \u0646\u0634\u0637"," ")}}function Y(n,s){1&n&&(t.j41(0,"th",40),t.EFF(1,"\u0622\u062e\u0631 \u0646\u0634\u0627\u0637"),t.k0s())}function X(n,s){if(1&n&&(t.j41(0,"td",41),t.EFF(1),t.k0s()),2&n){const e=s.$implicit,i=t.XpG(2);t.R7$(),t.JRh(i.formatDate(e.lastActive))}}function w(n,s){1&n&&(t.j41(0,"th",42),t.EFF(1,"\u0627\u0644\u0625\u062c\u0631\u0627\u0621\u0627\u062a"),t.k0s())}function z(n,s){if(1&n){const e=t.RV6();t.j41(0,"button",46),t.bIt("click",function(){t.eBV(e);const r=t.XpG().$implicit,a=t.XpG(2);return t.Njj(a.editUser(r))}),t.j41(1,"mat-icon"),t.EFF(2,"edit"),t.k0s(),t.j41(3,"span"),t.EFF(4,"\u062a\u0639\u062f\u064a\u0644"),t.k0s()()}}function J(n,s){if(1&n){const e=t.RV6();t.j41(0,"button",46),t.bIt("click",function(){t.eBV(e);const r=t.XpG().$implicit,a=t.XpG(2);return t.Njj(r.isActive?a.deactivateUser(r):a.activateUser(r))}),t.j41(1,"mat-icon"),t.EFF(2),t.k0s(),t.j41(3,"span"),t.EFF(4),t.k0s()()}if(2&n){const e=t.XpG().$implicit;t.R7$(2),t.JRh(e.isActive?"block":"check_circle"),t.R7$(2),t.JRh(e.isActive?"\u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u062a\u0641\u0639\u064a\u0644":"\u062a\u0641\u0639\u064a\u0644")}}function H(n,s){if(1&n){const e=t.RV6();t.j41(0,"button",46),t.bIt("click",function(){t.eBV(e);const r=t.XpG().$implicit,a=t.XpG(2);return t.Njj(a.deleteUser(r))}),t.j41(1,"mat-icon"),t.EFF(2,"delete"),t.k0s(),t.j41(3,"span"),t.EFF(4,"\u062d\u0630\u0641"),t.k0s()()}}function Q(n,s){if(1&n&&(t.j41(0,"td",41)(1,"button",44)(2,"mat-icon"),t.EFF(3,"more_vert"),t.k0s()(),t.j41(4,"mat-menu",null,0),t.DNE(6,z,5,0,"button",45)(7,J,5,2,"button",45)(8,H,5,0,"button",45),t.k0s()()),2&n){const e=t.sdS(5),i=t.XpG(2);t.R7$(),t.Y8G("matMenuTriggerFor",e),t.R7$(5),t.Y8G("ngIf",i.canEdit()),t.R7$(),t.Y8G("ngIf",i.canEdit()),t.R7$(),t.Y8G("ngIf",i.canDelete())}}function Z(n,s){1&n&&t.nrm(0,"tr",47)}function q(n,s){1&n&&t.nrm(0,"tr",48)}function tt(n,s){1&n&&(t.j41(0,"div",49)(1,"mat-icon"),t.EFF(2,"inbox"),t.k0s(),t.j41(3,"p"),t.EFF(4,"\u0644\u0627 \u062a\u0648\u062c\u062f \u0645\u0633\u062a\u062e\u062f\u0645\u064a\u0646"),t.k0s()())}function et(n,s){if(1&n&&(t.j41(0,"div",24)(1,"table",25),t.qex(2,26),t.DNE(3,I,2,0,"th",27)(4,y,2,1,"td",28),t.bVm(),t.qex(5,29),t.DNE(6,$,2,0,"th",27)(7,B,2,1,"td",28),t.bVm(),t.qex(8,30),t.DNE(9,G,2,0,"th",31)(10,S,2,1,"td",28),t.bVm(),t.qex(11,32),t.DNE(12,N,2,0,"th",27)(13,K,3,2,"td",28),t.bVm(),t.qex(14,33),t.DNE(15,W,2,0,"th",31)(16,V,3,2,"td",28),t.bVm(),t.qex(17,34),t.DNE(18,Y,2,0,"th",27)(19,X,2,1,"td",28),t.bVm(),t.qex(20,35),t.DNE(21,w,2,0,"th",31)(22,Q,9,4,"td",28),t.bVm(),t.DNE(23,Z,1,0,"tr",36)(24,q,1,0,"tr",37),t.k0s(),t.nrm(25,"mat-paginator",38),t.DNE(26,tt,5,0,"div",39),t.k0s()),2&n){const e=t.XpG();t.R7$(),t.Y8G("dataSource",e.dataSource),t.R7$(22),t.Y8G("matHeaderRowDef",e.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",e.displayedColumns),t.R7$(),t.Y8G("pageSizeOptions",t.lJ4(5,R)),t.R7$(),t.Y8G("ngIf",e.dataSource&&0===e.dataSource.filteredData.length)}}let nt=(()=>{class n{constructor(e,i,r,a){this.userService=e,this.authService=i,this.router=r,this.dialog=a,this.users=[],this.displayedColumns=["code","description","email","role","isActive","lastActive","actions"],this.searchTerm="",this.isLoading=!0,this.destroy$=new P.B,this.currentUser=this.authService.getCurrentUser()}ngOnInit(){this.loadUsers()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadUsers(){this.isLoading=!0,this.userService.getAllUsers().pipe((0,g.Q)(this.destroy$)).subscribe({next:e=>{this.users=e,this.initializeDataSource(),this.isLoading=!1},error:e=>{console.error("Error loading users:",e),this.isLoading=!1}})}initializeDataSource(){this.dataSource=new u.I6(this.users),setTimeout(()=>{this.sort&&(this.dataSource.sort=this.sort),this.paginator&&(this.dataSource.paginator=this.paginator)},100)}applyFilter(){const e=this.searchTerm.trim().toLowerCase();this.dataSource.filter=e}clearFilter(){this.searchTerm="",this.applyFilter()}editUser(e){this.router.navigate(["/app/document-management/users/edit",e.id])}deleteUser(e){confirm(`\u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u062d\u0630\u0641 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645 "${e.code}"\u061f`)&&this.userService.deleteUser(e.id).pipe((0,g.Q)(this.destroy$)).subscribe({next:()=>{this.loadUsers()},error:i=>{console.error("Error deleting user:",i),alert("\u0641\u0634\u0644 \u062d\u0630\u0641 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645")}})}activateUser(e){this.userService.activateUser(e.id).pipe((0,g.Q)(this.destroy$)).subscribe({next:()=>{this.loadUsers()},error:i=>{console.error("Error activating user:",i),alert("\u0641\u0634\u0644 \u062a\u0641\u0639\u064a\u0644 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645")}})}deactivateUser(e){confirm(`\u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u0625\u0644\u063a\u0627\u0621 \u062a\u0641\u0639\u064a\u0644 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645 "${e.code}"\u061f`)&&this.userService.deactivateUser(e.id).pipe((0,g.Q)(this.destroy$)).subscribe({next:()=>{this.loadUsers()},error:i=>{console.error("Error deactivating user:",i),alert("\u0641\u0634\u0644 \u0625\u0644\u063a\u0627\u0621 \u062a\u0641\u0639\u064a\u0644 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645")}})}navigateToCreate(){this.router.navigate(["/app/document-management/users/create"])}navigateToDashboard(){this.router.navigate(["/app/document-management/dashboard"])}getRoleColor(e){return{Admin:"warn",Member:"primary",Uploader:"accent"}[e]||""}getRoleLabel(e){return{Admin:"\u0645\u062f\u064a\u0631",Member:"\u0639\u0636\u0648",Uploader:"\u0645\u0631\u0641\u0639 \u0645\u0644\u0641\u0627\u062a"}[e]||e}canEdit(){return this.authService.isAdmin()}canDelete(){return this.authService.isAdmin()}formatDate(e){return e?("string"==typeof e?new Date(e):e).toLocaleDateString("ar-SA",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"\u063a\u064a\u0631 \u0645\u062a\u0648\u0641\u0631"}static{this.\u0275fac=function(i){return new(i||n)(t.rXU(A.G),t.rXU(L.u),t.rXU(d.Ix),t.rXU(U.bZ))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-users-list"]],viewQuery:function(i,r){if(1&i&&(t.GBs(h.B4,5),t.GBs(C.iy,5)),2&i){let a;t.mGM(a=t.lsd())&&(r.sort=a.first),t.mGM(a=t.lsd())&&(r.paginator=a.first)}},standalone:!0,features:[t.aNF],decls:36,vars:5,consts:[["menu","matMenu"],[1,"users-list-container",2,"margin-top","70px"],[1,"users-hero"],[1,"hero-content"],[1,"hero-logo-icon"],[1,"hero-title"],[1,"hero-subtitle"],[1,"users-card"],[1,"d-flex","align-items-center","justify-content-between"],[1,"title-section"],[1,"action-buttons"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["mat-button","",3,"click"],[1,"search-section"],["appearance","outline",1,"search-field"],["matInput","","placeholder","\u0627\u0628\u062d\u062b \u0639\u0646 \u0645\u0633\u062a\u062e\u062f\u0645...",3,"ngModelChange","keyup","ngModel"],["matPrefix",""],["mat-icon-button","","matSuffix","",3,"click",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","table-container",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],["mat-icon-button","","matSuffix","",3,"click"],[1,"loading-container"],["diameter","48"],[1,"table-container"],["mat-table","","matSort","",1,"users-table",3,"dataSource"],["matColumnDef","code"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","description"],["matColumnDef","email"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","role"],["matColumnDef","isActive"],["matColumnDef","lastActive"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["class","empty-state",4,"ngIf"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["selected","",3,"color"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row",""],[1,"empty-state"]],template:function(i,r){1&i&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"mat-icon",4),t.EFF(4,"people"),t.k0s(),t.j41(5,"h1",5)(6,"mat-icon"),t.EFF(7,"people"),t.k0s(),t.EFF(8," \u0625\u062f\u0627\u0631\u0629 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645\u064a\u0646 "),t.k0s(),t.j41(9,"p",6),t.EFF(10,"\u0625\u062f\u0627\u0631\u0629 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645\u064a\u0646 \u0648\u0627\u0644\u0623\u062f\u0648\u0627\u0631 \u0648\u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0627\u062a"),t.k0s()()(),t.j41(11,"mat-card",7)(12,"mat-card-header")(13,"mat-card-title",8)(14,"div",9)(15,"mat-icon"),t.EFF(16,"people"),t.k0s(),t.j41(17,"span"),t.EFF(18,"\u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645\u064a\u0646"),t.k0s()(),t.j41(19,"div",10),t.DNE(20,T,4,0,"button",11),t.j41(21,"button",12),t.bIt("click",function(){return r.navigateToDashboard()}),t.j41(22,"mat-icon"),t.EFF(23,"dashboard"),t.k0s(),t.EFF(24," \u0644\u0648\u062d\u0629 \u0627\u0644\u062a\u062d\u0643\u0645 "),t.k0s()()()(),t.j41(25,"mat-card-content")(26,"div",13)(27,"mat-form-field",14)(28,"mat-label"),t.EFF(29,"\u0628\u062d\u062b"),t.k0s(),t.j41(30,"input",15),t.mxI("ngModelChange",function(v){return t.DH7(r.searchTerm,v)||(r.searchTerm=v),v}),t.bIt("keyup",function(){return r.applyFilter()}),t.k0s(),t.j41(31,"mat-icon",16),t.EFF(32,"search"),t.k0s(),t.DNE(33,j,3,0,"button",17),t.k0s()(),t.DNE(34,k,4,0,"div",18)(35,et,27,6,"div",19),t.k0s()()()),2&i&&(t.R7$(20),t.Y8G("ngIf",r.canEdit()),t.R7$(10),t.R50("ngModel",r.searchTerm),t.R7$(3),t.Y8G("ngIf",r.searchTerm),t.R7$(),t.Y8G("ngIf",r.isLoading),t.R7$(),t.Y8G("ngIf",!r.isLoading))},dependencies:[m.MD,m.bT,p.YN,p.me,p.BC,p.vS,d.iI,c.Hu,c.RN,c.m2,c.MM,c.dh,E.Hl,E.$z,E.iY,F.m_,F.An,u.tP,u.Zl,u.tL,u.ji,u.cC,u.YV,u.iL,u.KS,u.$R,u.YZ,u.NB,C.Ou,C.iy,h.NQ,h.B4,h.aE,_.RG,_.rl,_.nJ,_.JW,_.yw,M.fS,M.fg,D.YN,D.Jl,b.uc,f.Cn,f.kk,f.fb,f.Cp,O.D6,O.LG,U.hM],styles:[".users-list-container[_ngcontent-%COMP%]{padding:24px;max-width:1400px;margin:0 auto}.users-hero[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border-radius:12px;padding:32px;margin-bottom:24px;color:#fff}.users-hero[_ngcontent-%COMP%]   .hero-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.users-hero[_ngcontent-%COMP%]   .hero-content[_ngcontent-%COMP%]   .hero-logo-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px}.users-hero[_ngcontent-%COMP%]   .hero-content[_ngcontent-%COMP%]   .hero-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin:0;font-size:28px;font-weight:600}.users-hero[_ngcontent-%COMP%]   .hero-content[_ngcontent-%COMP%]   .hero-subtitle[_ngcontent-%COMP%]{margin:8px 0 0;opacity:.9;font-size:16px}.users-card[_ngcontent-%COMP%]{box-shadow:0 2px 8px #0000001a}.users-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{margin-bottom:16px}.users-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   .title-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-size:20px;font-weight:600}.users-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:8px}.search-section[_ngcontent-%COMP%]{margin-bottom:24px}.search-section[_ngcontent-%COMP%]   .search-field[_ngcontent-%COMP%]{width:100%;max-width:400px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;gap:16px}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.users-table[_ngcontent-%COMP%]{width:100%}.users-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-weight:600;background-color:#f5f5f5}.users-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .users-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:12px 16px}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;gap:16px;color:#999}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px}"]})}}return n})()},5312:(x,l,o)=>{o.d(l,{c:()=>d});const d=o(1904).c}}]);