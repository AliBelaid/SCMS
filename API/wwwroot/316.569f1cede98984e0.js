"use strict";(self.webpackChunkvex=self.webpackChunkvex||[]).push([[316],{2385:(D,F,l)=>{l.d(F,{T:()=>h,h:()=>m});var h=function(o){return o[o.Created=1]="Created",o[o.Updated=2]="Updated",o[o.StatusChanged=3]="StatusChanged",o[o.PriorityChanged=4]="PriorityChanged",o[o.Assigned=5]="Assigned",o[o.AttachmentAdded=6]="AttachmentAdded",o[o.AttachmentRemoved=7]="AttachmentRemoved",o[o.PermissionGranted=8]="PermissionGranted",o[o.PermissionRevoked=9]="PermissionRevoked",o[o.DepartmentAccessGranted=10]="DepartmentAccessGranted",o[o.DepartmentAccessRevoked=11]="DepartmentAccessRevoked",o[o.UserExcluded=12]="UserExcluded",o[o.UserExclusionRemoved=13]="UserExclusionRemoved",o[o.ExpirationSet=14]="ExpirationSet",o[o.Archived=15]="Archived",o[o.Restored=16]="Restored",o[o.Deleted=17]="Deleted",o}(h||{}),m=function(o){return o[o.ViewOnly=1]="ViewOnly",o[o.Edit=2]="Edit",o[o.Full=3]="Full",o}(m||{})},8287:(D,F,l)=>{l.d(F,{a:()=>b});var h=l(1626),m=l(6354),o=l(5312),x=l(4438);let b=(()=>{class P{constructor(n){this.http=n,this.baseUrl=o.c.apiUrl}getAllDepartments(){return this.http.get(`${this.baseUrl}/departments`)}getDepartmentById(n){return this.http.get(`${this.baseUrl}/departments/${n}`)}addDepartment(n){return this.http.post(`${this.baseUrl}/departments`,n)}updateDepartment(n,s){return this.http.put(`${this.baseUrl}/departments/${n}`,s)}deleteDepartment(n){return this.http.delete(`${this.baseUrl}/departments/${n}`)}addUserToDepartment(n,s){return this.http.post(`${this.baseUrl}/departments/${n}/users`,s).pipe((0,m.T)(()=>!0))}removeUserFromDepartment(n,s){return this.http.delete(`${this.baseUrl}/departments/${n}/users/${s}`).pipe((0,m.T)(()=>!0))}updateDepartmentUser(n,s,_){return this.http.put(`${this.baseUrl}/departments/${n}/users/${s}`,_).pipe((0,m.T)(()=>!0))}getAvailableUsersForDepartment(n){return this.http.get(`${this.baseUrl}/departments/${n}/available-users`)}getSubjectsByDepartment(n){return this.http.get(`${this.baseUrl}/departments/${n}/subjects`)}addSubjectToDepartment(n,s){return this.http.post(`${this.baseUrl}/departments/${n}/subjects`,s).pipe((0,m.T)(()=>!0))}updateSubject(n,s,_){return this.http.put(`${this.baseUrl}/departments/${n}/subjects/${s}`,_).pipe((0,m.T)(()=>!0))}deleteSubject(n,s){return this.http.delete(`${this.baseUrl}/departments/${n}/subjects/${s}`).pipe((0,m.T)(()=>!0))}getAllOrders(){return this.http.get(`${this.baseUrl}/orders`)}getOrderById(n){return this.http.get(`${this.baseUrl}/orders/${n}`).pipe((0,m.T)(s=>{const _=(s.permissions||s.userPermissions||[]).map(d=>({id:d.id||0,userId:d.userId,userCode:d.userCode||"",userEmail:d.userEmail||"",canView:d.canView||!1,canEdit:d.canEdit||!1,canDelete:d.canDelete||!1,canShare:d.canShare||!1,canDownload:d.canDownload||!1,canPrint:d.canPrint||!1,canComment:d.canComment||!1,canApprove:d.canApprove||!1,grantedAt:d.grantedAt?new Date(d.grantedAt):new Date,expiresAt:d.expiresAt?new Date(d.expiresAt):void 0,isExpired:d.isExpired||!1,grantedByName:d.grantedByName||""}));return{...s,userPermissions:_}}))}getOrdersByType(n){return this.http.get(`${this.baseUrl}/orders/type/${n}`)}getOrdersByDepartment(n){return this.http.get(`${this.baseUrl}/orders/department/${n}`)}addOrder(n){return this.http.post(`${this.baseUrl}/orders`,n)}updateOrder(n,s){return this.http.put(`${this.baseUrl}/orders/${n}`,s)}deleteOrder(n){return this.http.delete(`${this.baseUrl}/orders/${n}`)}getOrderHistory(n,s=1,_=50){const v=(new h.Nl).set("pageNumber",s.toString()).set("pageSize",_.toString());return this.http.get(`${this.baseUrl}/orders/${n}/history`,{params:v})}getOrderHistoryCount(n){return this.http.get(`${this.baseUrl}/orders/${n}/history-count`)}getMyPermissions(n){return this.http.get(`${this.baseUrl}/orders/${n}/permissions/my`)}getOrderUserPermissions(n){return this.http.get(`${this.baseUrl}/orders/${n}/permissions/users`)}grantUserPermission(n,s){return this.http.post(`${this.baseUrl}/orders/${n}/permissions/user`,s)}revokeUserPermission(n,s){return this.http.delete(`${this.baseUrl}/orders/${n}/permissions/user/${s}`)}updateUserPermission(n,s,_){return this.http.put(`${this.baseUrl}/orders/${n}/permissions/user/${s}`,_)}getOrderDepartmentAccesses(n){return this.http.get(`${this.baseUrl}/orders/${n}/permissions/departments`)}grantDepartmentAccess(n,s){return this.http.post(`${this.baseUrl}/orders/${n}/permissions/department`,s)}revokeDepartmentAccess(n,s){return this.http.delete(`${this.baseUrl}/orders/${n}/permissions/department/${s}`)}getOrderUserExceptions(n){return this.http.get(`${this.baseUrl}/orders/${n}/permissions/user-exceptions`)}addUserException(n,s){return this.http.post(`${this.baseUrl}/orders/${n}/permissions/user-exception`,s)}removeUserException(n,s){return this.http.delete(`${this.baseUrl}/orders/${n}/permissions/user-exception/${s}`)}getAvailableUsers(){return this.http.get(`${this.baseUrl}/orders/permissions/available-users`)}setExpirationDate(n,s){return this.http.put(`${this.baseUrl}/orders/${n}/expiration`,s)}removeExpirationDate(n){return this.http.delete(`${this.baseUrl}/orders/${n}/expiration`)}getExpiredOrders(){return this.http.get(`${this.baseUrl}/orders/expired`)}getOrdersNearExpiration(n=7){const s=(new h.Nl).set("days",n.toString());return this.http.get(`${this.baseUrl}/orders/near-expiration`,{params:s})}getExpirationWarnings(){return this.http.get(`${this.baseUrl}/orders/expiration-warnings`)}archiveExpiredOrders(){return this.http.post(`${this.baseUrl}/orders/archive-expired`,{})}archiveOrder(n,s){return this.http.post(`${this.baseUrl}/orders/${n}/archive`,s)}getArchivedOrders(){return this.http.get(`${this.baseUrl}/orders/archived`)}restoreArchivedOrder(n){return this.http.post(`${this.baseUrl}/orders/archived/${n}/restore`,{})}permanentlyDeleteArchivedOrder(n){return this.http.delete(`${this.baseUrl}/orders/archived/${n}/permanent`)}uploadAttachment(n,s){const _=new FormData;return _.append("file",s),_.append("orderId",n),this.http.post(`${this.baseUrl}/orders/${n}/attachments`,_)}deleteAttachment(n,s){return this.http.delete(`${this.baseUrl}/orders/${n}/attachments/${s}`)}getDashboardStats(){return this.http.get(`${this.baseUrl}/orders/dashboard/stats`)}canViewOrder(n){return this.getMyPermissions(n).pipe((0,m.T)(s=>s.canView))}canEditOrder(n){return this.getMyPermissions(n).pipe((0,m.T)(s=>s.canEdit))}canDeleteOrder(n){return this.getMyPermissions(n).pipe((0,m.T)(s=>s.canDelete))}static{this.\u0275fac=function(s){return new(s||P)(x.KVO(h.Qq))}}static{this.\u0275prov=x.jDH({token:P,factory:P.\u0275fac,providedIn:"root"})}}return P})()},5316:(D,F,l)=>{l.d(F,{i:()=>he});var h=l(177),m=l(9417),o=l(4006),x=l(2102),b=l(9631),P=l(8834),A=l(9213),n=l(5596),s=l(6850),_=l(2798),v=l(6600),d=l(2765),g=l(6471),a=l(9159),f=l(9183),O=l(4823),C=l(3808),E=l(2385),e=l(4438),I=l(8287),k=l(9192),j=l(8203);const $=()=>["user","permissions","expires","actions"];function y(r,u){1&r&&(e.j41(0,"div",47),e.nrm(1,"mat-spinner",48),e.j41(2,"p"),e.EFF(3,"\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644..."),e.k0s()())}function R(r,u){1&r&&(e.j41(0,"div",49)(1,"mat-icon"),e.EFF(2,"person_off"),e.k0s(),e.j41(3,"p"),e.EFF(4,"\u0644\u0627 \u062a\u0648\u062c\u062f \u0635\u0644\u0627\u062d\u064a\u0627\u062a \u0645\u0633\u062a\u062e\u062f\u0645\u064a\u0646"),e.k0s()())}function T(r,u){1&r&&(e.j41(0,"th",59),e.EFF(1,"\u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645"),e.k0s())}function U(r,u){if(1&r&&(e.j41(0,"td",60)(1,"div",61)(2,"mat-icon"),e.EFF(3,"person"),e.k0s(),e.j41(4,"div")(5,"div",62),e.EFF(6),e.k0s(),e.j41(7,"div",63),e.EFF(8),e.k0s()()()()),2&r){const t=u.$implicit;e.R7$(6),e.JRh(t.userCode),e.R7$(2),e.JRh(t.userEmail)}}function B(r,u){1&r&&(e.j41(0,"th",59),e.EFF(1,"\u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0627\u062a"),e.k0s())}function S(r,u){1&r&&(e.j41(0,"mat-chip",68),e.EFF(1,"\u0639\u0631\u0636"),e.k0s())}function w(r,u){1&r&&(e.j41(0,"mat-chip",69),e.EFF(1,"\u062a\u0639\u062f\u064a\u0644"),e.k0s())}function G(r,u){1&r&&(e.j41(0,"mat-chip",70),e.EFF(1,"\u062d\u0630\u0641"),e.k0s())}function L(r,u){1&r&&(e.j41(0,"mat-chip"),e.EFF(1,"\u0645\u0634\u0627\u0631\u0643\u0629"),e.k0s())}function N(r,u){1&r&&(e.j41(0,"mat-chip"),e.EFF(1,"\u062a\u062d\u0645\u064a\u0644"),e.k0s())}function Y(r,u){1&r&&(e.j41(0,"mat-chip"),e.EFF(1,"\u0637\u0628\u0627\u0639\u0629"),e.k0s())}function V(r,u){1&r&&(e.j41(0,"mat-chip"),e.EFF(1,"\u062a\u0639\u0644\u064a\u0642"),e.k0s())}function K(r,u){1&r&&(e.j41(0,"mat-chip"),e.EFF(1,"\u0645\u0648\u0627\u0641\u0642\u0629"),e.k0s())}function z(r,u){if(1&r&&(e.j41(0,"td",60)(1,"div",64),e.DNE(2,S,2,0,"mat-chip",65)(3,w,2,0,"mat-chip",66)(4,G,2,0,"mat-chip",67)(5,L,2,0,"mat-chip",42)(6,N,2,0,"mat-chip",42)(7,Y,2,0,"mat-chip",42)(8,V,2,0,"mat-chip",42)(9,K,2,0,"mat-chip",42),e.k0s()()),2&r){const t=u.$implicit;e.R7$(2),e.Y8G("ngIf",t.canView),e.R7$(),e.Y8G("ngIf",t.canEdit),e.R7$(),e.Y8G("ngIf",t.canDelete),e.R7$(),e.Y8G("ngIf",t.canShare),e.R7$(),e.Y8G("ngIf",t.canDownload),e.R7$(),e.Y8G("ngIf",t.canPrint),e.R7$(),e.Y8G("ngIf",t.canComment),e.R7$(),e.Y8G("ngIf",t.canApprove)}}function W(r,u){1&r&&(e.j41(0,"th",59),e.EFF(1,"\u0627\u0644\u0627\u0646\u062a\u0647\u0627\u0621"),e.k0s())}function X(r,u){if(1&r&&(e.j41(0,"span"),e.EFF(1),e.k0s()),2&r){const t=e.XpG().$implicit,c=e.XpG(2);e.AVh("expired",t.isExpired),e.R7$(),e.SpI(" ",c.formatDate(t.expiresAt)," ")}}function H(r,u){1&r&&(e.j41(0,"span",73),e.EFF(1,"\u062f\u0627\u0626\u0645"),e.k0s())}function J(r,u){if(1&r&&(e.j41(0,"td",60),e.DNE(1,X,2,3,"span",71)(2,H,2,0,"span",72),e.k0s()),2&r){const t=u.$implicit;e.R7$(),e.Y8G("ngIf",t.expiresAt),e.R7$(),e.Y8G("ngIf",!t.expiresAt)}}function Z(r,u){1&r&&(e.j41(0,"th",59),e.EFF(1,"\u0627\u0644\u0625\u062c\u0631\u0627\u0621\u0627\u062a"),e.k0s())}function Q(r,u){if(1&r){const t=e.RV6();e.j41(0,"td",60)(1,"button",74),e.bIt("click",function(){const i=e.eBV(t).$implicit,p=e.XpG(2);return e.Njj(p.revokeUserPermission(i.userId))}),e.j41(2,"mat-icon"),e.EFF(3,"delete"),e.k0s()()()}}function q(r,u){1&r&&e.nrm(0,"tr",75)}function ee(r,u){1&r&&e.nrm(0,"tr",76)}function te(r,u){if(1&r&&(e.j41(0,"table",50),e.qex(1,51),e.DNE(2,T,2,0,"th",52)(3,U,9,2,"td",53),e.bVm(),e.qex(4,54),e.DNE(5,B,2,0,"th",52)(6,z,10,8,"td",53),e.bVm(),e.qex(7,55),e.DNE(8,W,2,0,"th",52)(9,J,3,2,"td",53),e.bVm(),e.qex(10,56),e.DNE(11,Z,2,0,"th",52)(12,Q,4,0,"td",53),e.bVm(),e.DNE(13,q,1,0,"tr",57)(14,ee,1,0,"tr",58),e.k0s()),2&r){const t=e.XpG();e.Y8G("dataSource",t.userPermissions),e.R7$(13),e.Y8G("matHeaderRowDef",e.lJ4(3,$)),e.R7$(),e.Y8G("matRowDefColumns",e.lJ4(4,$))}}function ne(r,u){if(1&r&&(e.j41(0,"mat-option",77),e.EFF(1),e.k0s()),2&r){const t=u.$implicit;e.Y8G("value",t.id),e.R7$(),e.Lme(" ",t.nameAr," (",t.code,") ")}}function re(r,u){if(1&r&&(e.j41(0,"mat-option",77),e.EFF(1),e.k0s()),2&r){const t=u.$implicit;e.Y8G("value",t.value),e.R7$(),e.SpI(" ",t.label," ")}}function ie(r,u){1&r&&(e.j41(0,"div",47),e.nrm(1,"mat-spinner",48),e.j41(2,"p"),e.EFF(3,"\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644..."),e.k0s()())}function se(r,u){1&r&&(e.j41(0,"div",49)(1,"mat-icon"),e.EFF(2,"business_center"),e.k0s(),e.j41(3,"p"),e.EFF(4,"\u0644\u0627 \u062a\u0648\u062c\u062f \u0625\u062f\u0627\u0631\u0627\u062a \u0644\u062f\u064a\u0647\u0627 \u0648\u0635\u0648\u0644"),e.k0s()())}function oe(r,u){if(1&r&&(e.j41(0,"span",89)(1,"mat-icon"),e.EFF(2,"event"),e.k0s(),e.EFF(3),e.k0s()),2&r){const t=e.XpG().$implicit,c=e.XpG(2);e.AVh("expired",t.isExpired),e.R7$(3),e.SpI(" ",c.formatDate(t.expiresAt)," ")}}function ae(r,u){if(1&r){const t=e.RV6();e.j41(0,"mat-card",80)(1,"mat-card-content")(2,"div",81)(3,"div",82)(4,"mat-icon"),e.EFF(5,"business"),e.k0s(),e.j41(6,"div")(7,"h3"),e.EFF(8),e.k0s(),e.j41(9,"p"),e.EFF(10),e.k0s()()(),e.j41(11,"mat-chip",83),e.EFF(12),e.k0s()(),e.j41(13,"div",84)(14,"span",85)(15,"mat-icon"),e.EFF(16,"person"),e.k0s(),e.EFF(17),e.k0s(),e.DNE(18,oe,4,3,"span",86),e.k0s(),e.j41(19,"div",87)(20,"button",5),e.bIt("click",function(){const i=e.eBV(t).$implicit,p=e.XpG(2);return e.Njj(p.navigateToDepartment(i.departmentId))}),e.j41(21,"mat-icon"),e.EFF(22,"location_on"),e.k0s(),e.EFF(23," \u0627\u0644\u0630\u0647\u0627\u0628 \u0644\u0644\u0625\u062f\u0627\u0631\u0629 "),e.k0s(),e.j41(24,"button",88),e.bIt("click",function(){const i=e.eBV(t).$implicit,p=e.XpG(2);return e.Njj(p.revokeDepartmentAccess(i.departmentId))}),e.j41(25,"mat-icon"),e.EFF(26,"cancel"),e.k0s(),e.EFF(27," \u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u0648\u0635\u0648\u0644 "),e.k0s()()()()}if(2&r){const t=u.$implicit;e.R7$(8),e.JRh(t.departmentNameAr),e.R7$(2),e.JRh(t.departmentCode),e.R7$(),e.Y8G("color",3===t.accessLevel?"primary":2===t.accessLevel?"accent":"basic"),e.R7$(),e.SpI(" ",t.accessLevelName," "),e.R7$(5),e.SpI(" \u0645\u0646\u062d \u0628\u0648\u0627\u0633\u0637\u0629: ",t.grantedByName," "),e.R7$(),e.Y8G("ngIf",t.expiresAt)}}function ue(r,u){if(1&r&&(e.j41(0,"div",78),e.DNE(1,ae,28,6,"mat-card",79),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.departmentAccesses)}}function ce(r,u){1&r&&(e.j41(0,"mat-error"),e.EFF(1," \u0627\u0644\u0633\u0628\u0628 \u0645\u0637\u0644\u0648\u0628 "),e.k0s())}function le(r,u){1&r&&(e.j41(0,"mat-error"),e.EFF(1," \u064a\u062c\u0628 \u0623\u0646 \u064a\u0643\u0648\u0646 \u0627\u0644\u0633\u0628\u0628 10 \u0623\u062d\u0631\u0641 \u0639\u0644\u0649 \u0627\u0644\u0623\u0642\u0644 "),e.k0s())}function me(r,u){1&r&&(e.j41(0,"div",47),e.nrm(1,"mat-spinner",48),e.j41(2,"p"),e.EFF(3,"\u062c\u0627\u0631\u064a \u0627\u0644\u062a\u062d\u0645\u064a\u0644..."),e.k0s()())}function de(r,u){1&r&&(e.j41(0,"div",49)(1,"mat-icon"),e.EFF(2,"check_circle"),e.k0s(),e.j41(3,"p"),e.EFF(4,"\u0644\u0627 \u062a\u0648\u062c\u062f \u0627\u0633\u062a\u062b\u0646\u0627\u0621\u0627\u062a"),e.k0s()())}function pe(r,u){if(1&r&&(e.j41(0,"span",89)(1,"mat-icon"),e.EFF(2,"event"),e.k0s(),e.EFF(3),e.k0s()),2&r){const t=e.XpG().$implicit,c=e.XpG(2);e.AVh("expired",t.isExpired),e.R7$(3),e.SpI(" ",c.formatDate(t.expiresAt)," ")}}function _e(r,u){if(1&r){const t=e.RV6();e.j41(0,"mat-card",92)(1,"mat-card-content")(2,"div",93)(3,"div",61)(4,"mat-icon",70),e.EFF(5,"block"),e.k0s(),e.j41(6,"div")(7,"h3"),e.EFF(8),e.k0s(),e.j41(9,"p"),e.EFF(10),e.k0s()()()(),e.j41(11,"div",94)(12,"mat-icon"),e.EFF(13,"info"),e.k0s(),e.j41(14,"span"),e.EFF(15),e.k0s()(),e.j41(16,"div",95)(17,"span",96)(18,"mat-icon"),e.EFF(19,"person"),e.k0s(),e.EFF(20),e.k0s(),e.DNE(21,pe,4,3,"span",86),e.k0s(),e.j41(22,"div",97)(23,"button",98),e.bIt("click",function(){const i=e.eBV(t).$implicit,p=e.XpG(2);return e.Njj(p.removeUserException(i.userId))}),e.j41(24,"mat-icon"),e.EFF(25,"check"),e.k0s(),e.EFF(26," \u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u0627\u0633\u062a\u062b\u0646\u0627\u0621 "),e.k0s()()()()}if(2&r){const t=u.$implicit;e.R7$(8),e.JRh(t.userCode),e.R7$(2),e.JRh(t.userEmail),e.R7$(5),e.JRh(t.reason),e.R7$(5),e.SpI(" \u0623\u0636\u064a\u0641 \u0628\u0648\u0627\u0633\u0637\u0629: ",t.addedByName," "),e.R7$(),e.Y8G("ngIf",t.expiresAt)}}function ge(r,u){if(1&r&&(e.j41(0,"div",90),e.DNE(1,_e,27,5,"mat-card",91),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.userExceptions)}}let he=(()=>{class r{constructor(t,c,i,p,M){this.dialogRef=t,this.data=c,this.orderService=i,this.fb=p,this.router=M,this.userPermissions=[],this.departmentAccesses=[],this.userExceptions=[],this.departments=[],this.users=[],this.activeTab=0,this.isLoading=!1,this.accessLevels=[{value:E.h.ViewOnly,label:"\u0639\u0631\u0636 \u0641\u0642\u0637",labelEn:"View Only"},{value:E.h.Edit,label:"\u062a\u0639\u062f\u064a\u0644",labelEn:"Edit"},{value:E.h.Full,label:"\u0643\u0627\u0645\u0644",labelEn:"Full"}],this.displayedColumns=["user","permissions","expires","actions"],this.orderId=c.orderId,this.orderTitle=c.orderTitle,this.initializeForms()}initializeForms(){this.userPermissionForm=this.fb.group({userCode:[""],userId:[0,m.k0.required],canView:[!0],canEdit:[!1],canDelete:[!1],canShare:[!1],canDownload:[!0],canPrint:[!0],canComment:[!0],canApprove:[!1],expiresAt:[null],notes:[""]}),this.departmentAccessForm=this.fb.group({departmentId:["",m.k0.required],accessLevel:[E.h.ViewOnly,m.k0.required],expiresAt:[null],notes:[""]}),this.userExceptionForm=this.fb.group({userCode:[""],userId:[0,m.k0.required],reason:["",[m.k0.required,m.k0.minLength(10)]],expiresAt:[null]})}ngOnInit(){this.loadPermissions(),this.loadDepartments(),this.loadUsers()}loadPermissions(){this.isLoading=!0,this.orderService.getOrderUserPermissions(this.orderId).subscribe({next:t=>{this.userPermissions=t},error:t=>console.error("Error loading user permissions:",t)}),this.orderService.getOrderDepartmentAccesses(this.orderId).subscribe({next:t=>{this.departmentAccesses=t},error:t=>console.error("Error loading department accesses:",t)}),this.orderService.getOrderUserExceptions(this.orderId).subscribe({next:t=>{this.userExceptions=t,this.isLoading=!1},error:t=>{console.error("Error loading user exceptions:",t),this.isLoading=!1}})}loadDepartments(){this.orderService.getAllDepartments().subscribe({next:t=>{this.departments=t},error:t=>console.error("Error loading departments:",t)})}loadUsers(){this.orderService.getAvailableUsers().subscribe({next:t=>{this.users=t},error:()=>{this.users=[]}})}grantUserPermission(){if(this.userPermissionForm.invalid)return;const t=this.userPermissionForm.value,c={userId:t.userId,canView:t.canView??!0,canEdit:t.canEdit??!1,canDelete:t.canDelete??!1,canShare:t.canShare??!1,canDownload:t.canDownload??!0,canPrint:t.canPrint??!0,canComment:t.canComment??!0,canApprove:t.canApprove??!1,expiresAt:t.expiresAt?new Date(t.expiresAt):void 0,notes:t.notes};this.orderService.grantUserPermission(this.orderId,c).subscribe({next:i=>{i?(alert("\u062a\u0645 \u0645\u0646\u062d \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0627\u062a \u0628\u0646\u062c\u0627\u062d"),this.loadPermissions(),this.userPermissionForm.reset({userId:0,canView:!0,canEdit:!1,canDelete:!1,canShare:!1,canDownload:!0,canPrint:!0,canComment:!0,canApprove:!1,expiresAt:null,notes:""})):alert("\u062a\u0639\u0630\u0631 \u0645\u0646\u062d \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0627\u062a")},error:i=>{console.error("Error granting permission:",i),alert("\u0641\u0634\u0644 \u0645\u0646\u062d \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0627\u062a")}})}addUserPermission(){this.grantUserPermission()}revokeUserPermission(t){confirm("\u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u0625\u0644\u063a\u0627\u0621 \u0635\u0644\u0627\u062d\u064a\u0627\u062a \u0647\u0630\u0627 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645\u061f")&&this.orderService.revokeUserPermission(this.orderId,t).subscribe({next:c=>{c?(alert("\u062a\u0645 \u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0627\u062a \u0628\u0646\u062c\u0627\u062d"),this.loadPermissions()):alert("\u062a\u0639\u0630\u0631 \u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0627\u062a")},error:c=>{console.error("Error revoking permission:",c),alert("\u0641\u0634\u0644 \u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0627\u062a")}})}grantDepartmentAccess(){if(this.departmentAccessForm.invalid)return;const t=this.departmentAccessForm.value,c={departmentId:t.departmentId,accessLevel:t.accessLevel,expiresAt:t.expiresAt?new Date(t.expiresAt):void 0,notes:t.notes};this.orderService.grantDepartmentAccess(this.orderId,c).subscribe({next:i=>{i?(alert("\u062a\u0645 \u0645\u0646\u062d \u0648\u0635\u0648\u0644 \u0627\u0644\u0625\u062f\u0627\u0631\u0629 \u0628\u0646\u062c\u0627\u062d"),this.loadPermissions(),this.departmentAccessForm.reset({departmentId:"",accessLevel:E.h.ViewOnly,expiresAt:null,notes:""})):alert("\u062a\u0639\u0630\u0631 \u0645\u0646\u062d \u0648\u0635\u0648\u0644 \u0627\u0644\u0625\u062f\u0627\u0631\u0629")},error:i=>{console.error("Error granting department access:",i),alert("\u0641\u0634\u0644 \u0645\u0646\u062d \u0648\u0635\u0648\u0644 \u0627\u0644\u0625\u062f\u0627\u0631\u0629")}})}addDepartmentAccess(){this.grantDepartmentAccess()}revokeDepartmentAccess(t){confirm("\u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u0625\u0644\u063a\u0627\u0621 \u0648\u0635\u0648\u0644 \u0647\u0630\u0647 \u0627\u0644\u0625\u062f\u0627\u0631\u0629\u061f")&&this.orderService.revokeDepartmentAccess(this.orderId,t.toString()).subscribe({next:c=>{c?(alert("\u062a\u0645 \u0625\u0644\u063a\u0627\u0621 \u0648\u0635\u0648\u0644 \u0627\u0644\u0625\u062f\u0627\u0631\u0629 \u0628\u0646\u062c\u0627\u062d"),this.loadPermissions()):alert("\u062a\u0639\u0630\u0631 \u0625\u0644\u063a\u0627\u0621 \u0648\u0635\u0648\u0644 \u0627\u0644\u0625\u062f\u0627\u0631\u0629")},error:c=>{console.error("Error revoking department access:",c),alert("\u0641\u0634\u0644 \u0625\u0644\u063a\u0627\u0621 \u0648\u0635\u0648\u0644 \u0627\u0644\u0625\u062f\u0627\u0631\u0629")}})}addUserException(){if(this.userExceptionForm.invalid)return;const t=this.userExceptionForm.value,c={userId:t.userId,reason:t.reason,expiresAt:t.expiresAt?new Date(t.expiresAt):void 0};this.orderService.addUserException(this.orderId,c).subscribe({next:i=>{i?(alert("\u062a\u0645 \u0627\u0633\u062a\u062b\u0646\u0627\u0621 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645 \u0628\u0646\u062c\u0627\u062d"),this.loadPermissions(),this.userExceptionForm.reset({userCode:"",userId:0,reason:"",expiresAt:null})):alert("\u062a\u0639\u0630\u0631 \u0627\u0633\u062a\u062b\u0646\u0627\u0621 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645")},error:i=>{console.error("Error adding user exception:",i),alert("\u0641\u0634\u0644 \u0627\u0633\u062a\u062b\u0646\u0627\u0621 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645")}})}removeUserException(t){confirm("\u0647\u0644 \u0623\u0646\u062a \u0645\u062a\u0623\u0643\u062f \u0645\u0646 \u0625\u0644\u063a\u0627\u0621 \u0627\u0633\u062a\u062b\u0646\u0627\u0621 \u0647\u0630\u0627 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645\u061f")&&this.orderService.removeUserException(this.orderId,t).subscribe({next:c=>{c?(alert("\u062a\u0645 \u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u0627\u0633\u062a\u062b\u0646\u0627\u0621 \u0628\u0646\u062c\u0627\u062d"),this.loadPermissions()):alert("\u062a\u0639\u0630\u0631 \u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u0627\u0633\u062a\u062b\u0646\u0627\u0621")},error:c=>{console.error("Error removing user exception:",c),alert("\u0641\u0634\u0644 \u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u0627\u0633\u062a\u062b\u0646\u0627\u0621")}})}getAccessLevelLabel(t){const c=this.accessLevels.find(i=>i.value===t);return c?c.label:"\u063a\u064a\u0631 \u0645\u0639\u0631\u0648\u0641"}formatDate(t){return t?("string"==typeof t?new Date(t):t).toLocaleDateString("ar-SA",{year:"numeric",month:"short",day:"numeric"}):""}close(){this.dialogRef.close()}navigateToOrderDetails(){this.dialogRef.close(),this.router.navigate(["/app/document-management/orders/details",this.orderId])}navigateToOrdersList(){this.dialogRef.close(),this.router.navigate(["/app/document-management/orders"])}navigateToDepartment(t){this.dialogRef.close(),this.router.navigate(["/app/document-management/departments"],{queryParams:{selected:t}})}static{this.\u0275fac=function(c){return new(c||r)(e.rXU(o.CP),e.rXU(o.Vh),e.rXU(I.a),e.rXU(m.ok),e.rXU(k.Ix))}}static{this.\u0275cmp=e.VBU({type:r,selectors:[["app-order-permissions"]],standalone:!0,features:[e.aNF],decls:161,vars:24,consts:[["dir","rtl",1,"permissions-dialog"],[1,"dialog-header"],[1,"title-group"],["mat-dialog-title",""],[1,"quick-nav"],["mat-stroked-button","","color","primary",3,"click"],["mat-stroked-button","",3,"click"],["mat-icon-button","","matTooltip","\u0625\u063a\u0644\u0627\u0642",3,"click"],["animationDuration","300ms",3,"selectedIndexChange","selectedIndex"],["label","\u0635\u0644\u0627\u062d\u064a\u0627\u062a \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645\u064a\u0646"],[1,"tab-content"],[1,"add-permission-card"],[3,"ngSubmit","formGroup"],[1,"form-grid"],["appearance","outline"],["matInput","","formControlName","userCode","placeholder","\u0645\u062b\u0627\u0644: user123"],["matInput","","type","number","formControlName","userId","placeholder","1"],["matInput","","type","date","formControlName","expiresAt"],[1,"permissions-grid"],["formControlName","canView"],["formControlName","canEdit"],["formControlName","canDelete"],["formControlName","canShare"],["formControlName","canDownload"],["formControlName","canPrint"],["formControlName","canComment"],["formControlName","canApprove"],["appearance","outline",1,"full-width"],["matInput","","formControlName","notes","rows","2"],[1,"form-actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"permissions-list-card"],["class","loading-state",4,"ngIf"],["class","empty-state",4,"ngIf"],["mat-table","","class","permissions-table",3,"dataSource",4,"ngIf"],["label","\u0648\u0635\u0648\u0644 \u0627\u0644\u0625\u062f\u0627\u0631\u0627\u062a"],["formControlName","departmentId"],[3,"value",4,"ngFor","ngForOf"],["formControlName","accessLevel"],["class","department-list",4,"ngIf"],["label","\u0627\u0644\u0627\u0633\u062a\u062b\u0646\u0627\u0621\u0627\u062a"],["matInput","","formControlName","reason","rows","3","placeholder","\u0645\u062b\u0627\u0644: \u0645\u0639\u0627\u0645\u0644\u0629 \u0633\u0631\u064a\u0629 - \u062a\u0636\u0627\u0631\u0628 \u0645\u0635\u0627\u0644\u062d"],[4,"ngIf"],["mat-raised-button","","color","warn","type","submit",3,"disabled"],["class","exceptions-list",4,"ngIf"],["align","end"],["mat-button","",3,"click"],[1,"loading-state"],["diameter","40"],[1,"empty-state"],["mat-table","",1,"permissions-table",3,"dataSource"],["matColumnDef","user"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","permissions"],["matColumnDef","expires"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],[1,"user-info"],[1,"user-code"],[1,"user-email"],[1,"permission-chips"],["color","primary",4,"ngIf"],["color","accent",4,"ngIf"],["color","warn",4,"ngIf"],["color","primary"],["color","accent"],["color","warn"],[3,"expired",4,"ngIf"],["class","no-expiry",4,"ngIf"],[1,"no-expiry"],["mat-icon-button","","color","warn","matTooltip","\u0625\u0644\u063a\u0627\u0621 \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0627\u062a",3,"click"],["mat-header-row",""],["mat-row",""],[3,"value"],[1,"department-list"],["class","department-card",4,"ngFor","ngForOf"],[1,"department-card"],[1,"department-header"],[1,"department-info"],[3,"color"],[1,"department-meta"],[1,"granted-info"],["class","expiry-info",3,"expired",4,"ngIf"],[1,"department-actions"],["mat-raised-button","","color","warn",3,"click"],[1,"expiry-info"],[1,"exceptions-list"],["class","exception-card",4,"ngFor","ngForOf"],[1,"exception-card"],[1,"exception-header"],[1,"exception-reason"],[1,"exception-meta"],[1,"added-info"],[1,"exception-actions"],["mat-raised-button","","color","primary",3,"click"]],template:function(c,i){if(1&c&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3)(4,"mat-icon"),e.EFF(5,"security"),e.k0s(),e.EFF(6),e.k0s(),e.j41(7,"div",4)(8,"button",5),e.bIt("click",function(){return i.navigateToOrderDetails()}),e.j41(9,"mat-icon"),e.EFF(10,"open_in_new"),e.k0s(),e.EFF(11," \u0639\u0631\u0636 \u062a\u0641\u0627\u0635\u064a\u0644 \u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0629 "),e.k0s(),e.j41(12,"button",6),e.bIt("click",function(){return i.navigateToOrdersList()}),e.j41(13,"mat-icon"),e.EFF(14,"list"),e.k0s(),e.EFF(15," \u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0627\u062a "),e.k0s()()(),e.j41(16,"button",7),e.bIt("click",function(){return i.close()}),e.j41(17,"mat-icon"),e.EFF(18,"close"),e.k0s()()(),e.j41(19,"mat-dialog-content")(20,"mat-tab-group",8),e.mxI("selectedIndexChange",function(M){return e.DH7(i.activeTab,M)||(i.activeTab=M),M}),e.j41(21,"mat-tab",9)(22,"div",10)(23,"mat-card",11)(24,"mat-card-header")(25,"mat-card-title"),e.EFF(26,"\u0645\u0646\u062d \u0635\u0644\u0627\u062d\u064a\u0627\u062a \u0644\u0645\u0633\u062a\u062e\u062f\u0645"),e.k0s()(),e.j41(27,"mat-card-content")(28,"form",12),e.bIt("ngSubmit",function(){return i.grantUserPermission()}),e.j41(29,"div",13)(30,"mat-form-field",14)(31,"mat-label"),e.EFF(32,"\u0631\u0645\u0632 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645"),e.k0s(),e.nrm(33,"input",15),e.k0s(),e.j41(34,"mat-form-field",14)(35,"mat-label"),e.EFF(36,"\u0645\u0639\u0631\u0641 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645"),e.k0s(),e.nrm(37,"input",16),e.k0s(),e.j41(38,"mat-form-field",14)(39,"mat-label"),e.EFF(40,"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0627\u0646\u062a\u0647\u0627\u0621 (\u0627\u062e\u062a\u064a\u0627\u0631\u064a)"),e.k0s(),e.nrm(41,"input",17),e.k0s()(),e.j41(42,"div",18)(43,"mat-checkbox",19),e.EFF(44,"\u0639\u0631\u0636"),e.k0s(),e.j41(45,"mat-checkbox",20),e.EFF(46,"\u062a\u0639\u062f\u064a\u0644"),e.k0s(),e.j41(47,"mat-checkbox",21),e.EFF(48,"\u062d\u0630\u0641"),e.k0s(),e.j41(49,"mat-checkbox",22),e.EFF(50,"\u0645\u0634\u0627\u0631\u0643\u0629"),e.k0s(),e.j41(51,"mat-checkbox",23),e.EFF(52,"\u062a\u062d\u0645\u064a\u0644"),e.k0s(),e.j41(53,"mat-checkbox",24),e.EFF(54,"\u0637\u0628\u0627\u0639\u0629"),e.k0s(),e.j41(55,"mat-checkbox",25),e.EFF(56,"\u062a\u0639\u0644\u064a\u0642"),e.k0s(),e.j41(57,"mat-checkbox",26),e.EFF(58,"\u0645\u0648\u0627\u0641\u0642\u0629"),e.k0s()(),e.j41(59,"mat-form-field",27)(60,"mat-label"),e.EFF(61,"\u0645\u0644\u0627\u062d\u0638\u0627\u062a"),e.k0s(),e.nrm(62,"textarea",28),e.k0s(),e.j41(63,"div",29)(64,"button",30)(65,"mat-icon"),e.EFF(66,"add"),e.k0s(),e.EFF(67," \u0645\u0646\u062d \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0627\u062a "),e.k0s()()()()(),e.j41(68,"mat-card",31)(69,"mat-card-header")(70,"mat-card-title"),e.EFF(71),e.k0s()(),e.j41(72,"mat-card-content"),e.DNE(73,y,4,0,"div",32)(74,R,5,0,"div",33)(75,te,15,5,"table",34),e.k0s()()()(),e.j41(76,"mat-tab",35)(77,"div",10)(78,"mat-card",11)(79,"mat-card-header")(80,"mat-card-title"),e.EFF(81,"\u0645\u0646\u062d \u0648\u0635\u0648\u0644 \u0644\u0625\u062f\u0627\u0631\u0629"),e.k0s()(),e.j41(82,"mat-card-content")(83,"form",12),e.bIt("ngSubmit",function(){return i.grantDepartmentAccess()}),e.j41(84,"div",13)(85,"mat-form-field",14)(86,"mat-label"),e.EFF(87,"\u0627\u0644\u0625\u062f\u0627\u0631\u0629"),e.k0s(),e.j41(88,"mat-select",36),e.DNE(89,ne,2,3,"mat-option",37),e.k0s()(),e.j41(90,"mat-form-field",14)(91,"mat-label"),e.EFF(92,"\u0645\u0633\u062a\u0648\u0649 \u0627\u0644\u0648\u0635\u0648\u0644"),e.k0s(),e.j41(93,"mat-select",38),e.DNE(94,re,2,2,"mat-option",37),e.k0s()(),e.j41(95,"mat-form-field",14)(96,"mat-label"),e.EFF(97,"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0627\u0646\u062a\u0647\u0627\u0621 (\u0627\u062e\u062a\u064a\u0627\u0631\u064a)"),e.k0s(),e.nrm(98,"input",17),e.k0s()(),e.j41(99,"mat-form-field",27)(100,"mat-label"),e.EFF(101,"\u0645\u0644\u0627\u062d\u0638\u0627\u062a"),e.k0s(),e.nrm(102,"textarea",28),e.k0s(),e.j41(103,"div",29)(104,"button",30)(105,"mat-icon"),e.EFF(106,"add"),e.k0s(),e.EFF(107," \u0645\u0646\u062d \u0627\u0644\u0648\u0635\u0648\u0644 "),e.k0s()()()()(),e.j41(108,"mat-card",31)(109,"mat-card-header")(110,"mat-card-title"),e.EFF(111),e.k0s()(),e.j41(112,"mat-card-content"),e.DNE(113,ie,4,0,"div",32)(114,se,5,0,"div",33)(115,ue,2,1,"div",39),e.k0s()()()(),e.j41(116,"mat-tab",40)(117,"div",10)(118,"mat-card",11)(119,"mat-card-header")(120,"mat-card-title"),e.EFF(121,"\u0625\u0636\u0627\u0641\u0629 \u0627\u0633\u062a\u062b\u0646\u0627\u0621 \u0645\u0633\u062a\u062e\u062f\u0645"),e.k0s(),e.j41(122,"mat-card-subtitle"),e.EFF(123,"\u0645\u0646\u0639 \u0645\u0633\u062a\u062e\u062f\u0645 \u0645\u0639\u064a\u0646 \u0645\u0646 \u0627\u0644\u0648\u0635\u0648\u0644 \u062d\u062a\u0649 \u0644\u0648 \u0643\u0627\u0646 \u0641\u064a \u0625\u062f\u0627\u0631\u0629 \u0644\u062f\u064a\u0647\u0627 \u0648\u0635\u0648\u0644"),e.k0s()(),e.j41(124,"mat-card-content")(125,"form",12),e.bIt("ngSubmit",function(){return i.addUserException()}),e.j41(126,"div",13)(127,"mat-form-field",14)(128,"mat-label"),e.EFF(129,"\u0631\u0645\u0632 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645"),e.k0s(),e.nrm(130,"input",15),e.k0s(),e.j41(131,"mat-form-field",14)(132,"mat-label"),e.EFF(133,"\u0645\u0639\u0631\u0641 \u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645"),e.k0s(),e.nrm(134,"input",16),e.k0s(),e.j41(135,"mat-form-field",14)(136,"mat-label"),e.EFF(137,"\u062a\u0627\u0631\u064a\u062e \u0627\u0644\u0627\u0646\u062a\u0647\u0627\u0621 (\u0627\u062e\u062a\u064a\u0627\u0631\u064a)"),e.k0s(),e.nrm(138,"input",17),e.k0s()(),e.j41(139,"mat-form-field",27)(140,"mat-label"),e.EFF(141,"\u0633\u0628\u0628 \u0627\u0644\u0627\u0633\u062a\u062b\u0646\u0627\u0621"),e.k0s(),e.nrm(142,"textarea",41),e.DNE(143,ce,2,0,"mat-error",42)(144,le,2,0,"mat-error",42),e.k0s(),e.j41(145,"div",29)(146,"button",43)(147,"mat-icon"),e.EFF(148,"block"),e.k0s(),e.EFF(149," \u0625\u0636\u0627\u0641\u0629 \u0627\u0633\u062a\u062b\u0646\u0627\u0621 "),e.k0s()()()()(),e.j41(150,"mat-card",31)(151,"mat-card-header")(152,"mat-card-title"),e.EFF(153),e.k0s()(),e.j41(154,"mat-card-content"),e.DNE(155,me,4,0,"div",32)(156,de,5,0,"div",33)(157,ge,2,1,"div",44),e.k0s()()()()()(),e.j41(158,"mat-dialog-actions",45)(159,"button",46),e.bIt("click",function(){return i.close()}),e.EFF(160,"\u0625\u063a\u0644\u0627\u0642"),e.k0s()()()),2&c){let p,M;e.R7$(6),e.SpI(" \u0625\u062f\u0627\u0631\u0629 \u0627\u0644\u0635\u0644\u0627\u062d\u064a\u0627\u062a: ",i.data.orderTitle," "),e.R7$(14),e.R50("selectedIndex",i.activeTab),e.R7$(8),e.Y8G("formGroup",i.userPermissionForm),e.R7$(36),e.Y8G("disabled",i.userPermissionForm.invalid),e.R7$(7),e.SpI("\u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645\u0648\u0646 \u0627\u0644\u062d\u0627\u0644\u064a\u0648\u0646 (",i.userPermissions.length,")"),e.R7$(2),e.Y8G("ngIf",i.isLoading),e.R7$(),e.Y8G("ngIf",!i.isLoading&&0===i.userPermissions.length),e.R7$(),e.Y8G("ngIf",!i.isLoading&&i.userPermissions.length>0),e.R7$(8),e.Y8G("formGroup",i.departmentAccessForm),e.R7$(6),e.Y8G("ngForOf",i.departments),e.R7$(5),e.Y8G("ngForOf",i.accessLevels),e.R7$(10),e.Y8G("disabled",i.departmentAccessForm.invalid),e.R7$(7),e.SpI("\u0627\u0644\u0625\u062f\u0627\u0631\u0627\u062a \u0627\u0644\u062d\u0627\u0644\u064a\u0629 (",i.departmentAccesses.length,")"),e.R7$(2),e.Y8G("ngIf",i.isLoading),e.R7$(),e.Y8G("ngIf",!i.isLoading&&0===i.departmentAccesses.length),e.R7$(),e.Y8G("ngIf",!i.isLoading&&i.departmentAccesses.length>0),e.R7$(10),e.Y8G("formGroup",i.userExceptionForm),e.R7$(18),e.Y8G("ngIf",null==(p=i.userExceptionForm.get("reason"))?null:p.hasError("required")),e.R7$(),e.Y8G("ngIf",null==(M=i.userExceptionForm.get("reason"))?null:M.hasError("minlength")),e.R7$(2),e.Y8G("disabled",i.userExceptionForm.invalid),e.R7$(7),e.SpI("\u0627\u0644\u0645\u0633\u062a\u062e\u062f\u0645\u0648\u0646 \u0627\u0644\u0645\u0633\u062a\u062b\u0646\u0648\u0646 (",i.userExceptions.length,")"),e.R7$(2),e.Y8G("ngIf",i.isLoading),e.R7$(),e.Y8G("ngIf",!i.isLoading&&0===i.userExceptions.length),e.R7$(),e.Y8G("ngIf",!i.isLoading&&i.userExceptions.length>0)}},dependencies:[h.MD,h.Sq,h.bT,m.YN,m.qT,m.me,m.Q0,m.BC,m.cb,m.X1,m.j4,m.JD,C.yh,o.hM,j.ig,o.BI,o.E7,o.Yi,x.RG,x.rl,x.nJ,x.TL,b.fS,b.fg,P.Hl,P.$z,P.iY,A.m_,A.An,n.Hu,n.RN,n.m2,n.MM,n.Lc,n.dh,s.RI,s.mq,s.T8,_.Ve,_.VO,v.wT,v.Sy,d.g7,d.So,g.YN,g.Jl,a.tP,a.Zl,a.tL,a.ji,a.cC,a.YV,a.iL,a.KS,a.$R,a.YZ,a.NB,f.D6,f.LG,O.uc,O.oV],styles:[".permissions-dialog[_ngcontent-%COMP%]{direction:rtl;min-width:800px;max-width:1200px}.permissions-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px 24px;border-bottom:1px solid #e0e0e0}.permissions-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin:0;font-size:1.5rem;color:#333}.permissions-dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#667eea}.permissions-dialog[_ngcontent-%COMP%]   mat-dialog-content[_ngcontent-%COMP%]{padding:0;overflow:hidden}.permissions-dialog[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]{padding:24px;max-height:600px;overflow-y:auto}.permissions-dialog[_ngcontent-%COMP%]   .add-permission-card[_ngcontent-%COMP%]{margin-bottom:24px;border-radius:12px;box-shadow:0 2px 8px #0000001a}.permissions-dialog[_ngcontent-%COMP%]   .add-permission-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:16px;border-radius:12px 12px 0 0}.permissions-dialog[_ngcontent-%COMP%]   .add-permission-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{margin:0;font-size:1.1rem}.permissions-dialog[_ngcontent-%COMP%]   .add-permission-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{color:#ffffffe6;margin-top:4px}.permissions-dialog[_ngcontent-%COMP%]   .add-permission-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:24px}.permissions-dialog[_ngcontent-%COMP%]   .form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-bottom:16px}.permissions-dialog[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%}.permissions-dialog[_ngcontent-%COMP%]   .permissions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:12px;margin:16px 0;padding:16px;background:#f5f7fa;border-radius:8px}.permissions-dialog[_ngcontent-%COMP%]   .permissions-grid[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]     .mdc-checkbox__background{border-color:#667eea}.permissions-dialog[_ngcontent-%COMP%]   .permissions-grid[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]     .mdc-checkbox--selected .mdc-checkbox__background{background-color:#667eea;border-color:#667eea}.permissions-dialog[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:16px}.permissions-dialog[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-left:8px}.permissions-dialog[_ngcontent-%COMP%]   .permissions-list-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 2px 8px #0000001a}.permissions-dialog[_ngcontent-%COMP%]   .permissions-list-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background:#f8f9fa;padding:16px;border-radius:12px 12px 0 0;border-bottom:1px solid #e0e0e0}.permissions-dialog[_ngcontent-%COMP%]   .permissions-list-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{margin:0;color:#333;font-size:1.1rem}.permissions-dialog[_ngcontent-%COMP%]   .permissions-list-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:16px}.permissions-dialog[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%], .permissions-dialog[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;color:#666}.permissions-dialog[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .permissions-dialog[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;margin-bottom:16px;opacity:.5}.permissions-dialog[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .permissions-dialog[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:1rem}.permissions-dialog[_ngcontent-%COMP%]   .permissions-table[_ngcontent-%COMP%]{width:100%}.permissions-dialog[_ngcontent-%COMP%]   .permissions-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#f8f9fa;font-weight:600;color:#333}.permissions-dialog[_ngcontent-%COMP%]   .permissions-table[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.permissions-dialog[_ngcontent-%COMP%]   .permissions-table[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#667eea}.permissions-dialog[_ngcontent-%COMP%]   .permissions-table[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   .user-code[_ngcontent-%COMP%]{font-weight:600;color:#333}.permissions-dialog[_ngcontent-%COMP%]   .permissions-table[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   .user-email[_ngcontent-%COMP%]{font-size:.85rem;color:#666}.permissions-dialog[_ngcontent-%COMP%]   .permissions-table[_ngcontent-%COMP%]   .permission-chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:4px}.permissions-dialog[_ngcontent-%COMP%]   .permissions-table[_ngcontent-%COMP%]   .permission-chips[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{font-size:.75rem;height:24px;min-height:24px;padding:0 8px}.permissions-dialog[_ngcontent-%COMP%]   .permissions-table[_ngcontent-%COMP%]   .no-expiry[_ngcontent-%COMP%]{color:#4caf50;font-weight:500}.permissions-dialog[_ngcontent-%COMP%]   .permissions-table[_ngcontent-%COMP%]   .expired[_ngcontent-%COMP%]{color:#f44336;font-weight:500}.permissions-dialog[_ngcontent-%COMP%]   .department-list[_ngcontent-%COMP%], .permissions-dialog[_ngcontent-%COMP%]   .exceptions-list[_ngcontent-%COMP%]{display:grid;gap:16px}.permissions-dialog[_ngcontent-%COMP%]   .department-card[_ngcontent-%COMP%], .permissions-dialog[_ngcontent-%COMP%]   .exception-card[_ngcontent-%COMP%]{border-radius:8px;box-shadow:0 2px 4px #0000001a;transition:transform .2s ease,box-shadow .2s ease}.permissions-dialog[_ngcontent-%COMP%]   .department-card[_ngcontent-%COMP%]:hover, .permissions-dialog[_ngcontent-%COMP%]   .exception-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000026}.permissions-dialog[_ngcontent-%COMP%]   .department-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%], .permissions-dialog[_ngcontent-%COMP%]   .exception-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:16px}.permissions-dialog[_ngcontent-%COMP%]   .department-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.permissions-dialog[_ngcontent-%COMP%]   .department-header[_ngcontent-%COMP%]   .department-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.permissions-dialog[_ngcontent-%COMP%]   .department-header[_ngcontent-%COMP%]   .department-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#667eea;font-size:32px;width:32px;height:32px}.permissions-dialog[_ngcontent-%COMP%]   .department-header[_ngcontent-%COMP%]   .department-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;color:#333}.permissions-dialog[_ngcontent-%COMP%]   .department-header[_ngcontent-%COMP%]   .department-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;font-size:.9rem;color:#666}.permissions-dialog[_ngcontent-%COMP%]   .department-meta[_ngcontent-%COMP%], .permissions-dialog[_ngcontent-%COMP%]   .exception-meta[_ngcontent-%COMP%]{display:flex;gap:16px;margin:12px 0;font-size:.85rem;color:#666}.permissions-dialog[_ngcontent-%COMP%]   .department-meta[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .permissions-dialog[_ngcontent-%COMP%]   .exception-meta[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}.permissions-dialog[_ngcontent-%COMP%]   .department-meta[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .permissions-dialog[_ngcontent-%COMP%]   .exception-meta[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.permissions-dialog[_ngcontent-%COMP%]   .department-meta[_ngcontent-%COMP%]   .expired[_ngcontent-%COMP%], .permissions-dialog[_ngcontent-%COMP%]   .exception-meta[_ngcontent-%COMP%]   .expired[_ngcontent-%COMP%]{color:#f44336}.permissions-dialog[_ngcontent-%COMP%]   .department-actions[_ngcontent-%COMP%], .permissions-dialog[_ngcontent-%COMP%]   .exception-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:12px}.permissions-dialog[_ngcontent-%COMP%]   .department-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .permissions-dialog[_ngcontent-%COMP%]   .exception-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-left:8px}.permissions-dialog[_ngcontent-%COMP%]   .exception-header[_ngcontent-%COMP%]{margin-bottom:12px}.permissions-dialog[_ngcontent-%COMP%]   .exception-header[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.permissions-dialog[_ngcontent-%COMP%]   .exception-header[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px}.permissions-dialog[_ngcontent-%COMP%]   .exception-header[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;color:#333}.permissions-dialog[_ngcontent-%COMP%]   .exception-header[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;font-size:.9rem;color:#666}.permissions-dialog[_ngcontent-%COMP%]   .exception-reason[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;padding:12px;background:#fff3cd;border-radius:8px;margin:12px 0}.permissions-dialog[_ngcontent-%COMP%]   .exception-reason[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#856404;font-size:20px;width:20px;height:20px}.permissions-dialog[_ngcontent-%COMP%]   .exception-reason[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;color:#856404;font-size:.9rem;line-height:1.5}.permissions-dialog[_ngcontent-%COMP%]   mat-dialog-actions[_ngcontent-%COMP%]{padding:16px 24px;border-top:1px solid #e0e0e0}@media (max-width: 768px){.permissions-dialog[_ngcontent-%COMP%]{min-width:unset;width:100%}.permissions-dialog[_ngcontent-%COMP%]   .permissions-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.permissions-dialog[_ngcontent-%COMP%]   .form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}"]})}}return r})()},5312:(D,F,l)=>{l.d(F,{c:()=>m});const m=l(1904).c},3808:(D,F,l)=>{l.d(F,{yh:()=>_});var h=l(4438),m=l(8617);(0,l(6600).J8)(class b{constructor(g,a,f,O,C){this._defaultErrorStateMatcher=g,this._parentForm=a,this._parentFormGroup=f,this.ngControl=O,this.stateChanges=C}}),new h.nKC("ngx-mat-file-input.config");let _=(()=>{class d{}return d.\u0275fac=function(a){return new(a||d)},d.\u0275mod=h.$C({type:d}),d.\u0275inj=h.G2t({providers:[m.FN]}),d})()}}]);